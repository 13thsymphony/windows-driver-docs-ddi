---
UID: NF.prcomoem.IPrintOemUI2.DocumentEvent
title: IPrintOemUI2::DocumentEvent
author: windows-driver-content
description: The IPrintOemUI2::DocumentEvent method allows a UI plug-in to replace the core driver UI module's default implementation of the DrvDocumentEvent DDI.
old-location: print\iprintoemui2_documentevent.htm
old-project: print
ms.assetid: c98d1510-7db8-4fd6-a95f-1906f553d1c5
ms.author: windowsdriverdev
ms.date: 11/24/2017
ms.keywords: IPrintOemUI2, DocumentEvent, IPrintOemUI2::DocumentEvent
ms.prod: windows-hardware
ms.technology: windows-devices
ms.topic: function
req.header: prcomoem.h
req.include-header: Prcomoem.h
req.target-type: Desktop
req.target-min-winverclnt: 
req.target-min-winversvr: 
req.kmdf-ver: 
req.umdf-ver: 
req.alt-api: IPrintOemUI2.DocumentEvent
req.alt-loc: prcomoem.h
req.ddi-compliance: 
req.unicode-ansi: 
req.idl: 
req.max-support: 
req.namespace: 
req.assembly: 
req.type-library: 
req.lib: 
req.dll: 
req.irql: 
req.iface: IPrintOemUI2
req.product: Windows 10 or later.
---

# IPrintOemUI2::DocumentEvent method



## -description
<p>The <code>IPrintOemUI2::DocumentEvent</code> method allows a UI plug-in to replace the core driver UI module's default implementation of the <a href="..\winddiui\nf-winddiui-drvdocumentevent.md">DrvDocumentEvent</a> DDI.</p>


## -syntax

````
HRESULT DocumentEvent(
   HANDLE hPrinter,
   HDC    hdc,
   INT    iEsc,
   ULONG  cbIn,
   PVOID  pvIn,
   ULONG  cbOut,
   PVOID  pvOut,
   PINT   piResult
);
````


## -parameters
<dl>

### -param hPrinter 

<dd>
<p>Caller-supplied printer handle.</p>
</dd>

### -param hdc 

<dd>
<p>Caller-supplied device context handle, generated by a <b>CreateDC</b> call. This is zero if <i>iEsc</i> is DOCUMENTEVENT_CREATEDCPRE.</p>
</dd>

### -param iEsc 

<dd>
<p>Caller-supplied escape code identifying the event to be handled. This parameter can be one of the following integer constants:</p>
<table>
<tr>
<th>Escape Code</th>
<th>Meaning</th>
</tr>
<tr>
<td>
<p>DOCUMENTEVENT_ABORTDOC</p>
</td>
<td>
<p>GDI is about to process a call to its <b>AbortDoc</b> function.</p>
</td>
</tr>
<tr>
<td>
<p>DOCUMENTEVENT_CREATEDCPOST</p>
</td>
<td>
<p>GDI has just processed a call to its <b>CreateDC</b> or <b>CreateIC</b> function.</p>
<p>This escape code should not be used unless there has been a previous call to <b>DrvDocumentEvent</b> with <i>iEsc</i> set to DOCUMENTEVENT_CREATEDCPRE.</p>
</td>
</tr>
<tr>
<td>
<p>DOCUMENTEVENT_CREATEDCPRE</p>
</td>
<td>
<p>GDI is about to process a call to its <b>CreateDC</b> or <b>CreateIC</b> function.</p>
</td>
</tr>
<tr>
<td>
<p>DOCUMENTEVENT_DELETEDC</p>
</td>
<td>
<p>GDI is about to process a call to its <b>DeleteDC</b> function.</p>
</td>
</tr>
<tr>
<td>
<p>DOCUMENTEVENT_ENDDOCPOST</p>
</td>
<td>
<p>GDI has just processed a call to its <b>EndDoc</b> function.</p>
</td>
</tr>
<tr>
<td>
<p>DOCUMENTEVENT_ENDDOCPRE </p>
<p>or</p>
<p>DOCUMENTEVENT_ENDDOC</p>
</td>
<td>
<p>GDI is about to process a call to its <b>EndDoc</b> function.</p>
</td>
</tr>
<tr>
<td>
<p>DOCUMENTEVENT_ENDPAGE</p>
</td>
<td>
<p>GDI is about to process a call to its <b>EndPage</b> function.</p>
</td>
</tr>
<tr>
<td>
<p>DOCUMENTEVENT_ESCAPE</p>
</td>
<td>
<p>GDI is about to process a call to its <b>ExtEscape</b> function.</p>
</td>
</tr>
<tr>
<td>
<p>DOCUMENTEVENT_QUERYFILTER</p>
</td>
<td>
<p>The DOCUMENTEVENT_QUERYFILTER event represents an opportunity for the spooler to query the driver for a list of the DOCUMENTEVENT_<i>XXX</i> events to which the driver will respond. This event is issued just prior to a call to <b>DrvDocumentEvent</b> that passes the DOCUMENTEVENT_CREATEDCPRE event.</p>
</td>
</tr>
<tr>
<td>
<p>DOCUMENTEVENT_RESETDCPOST</p>
</td>
<td>
<p>GDI has just processed a call to its <b>ResetDC</b> function.</p>
<p>This escape code should not be used unless there has been a previous call to <b>DrvDocumentEvent</b> with <i>iEsc</i> set to DOCUMENTEVENT_RESETDCPRE.</p>
</td>
</tr>
<tr>
<td>
<p>DOCUMENTEVENT_RESETDCPRE</p>
</td>
<td>
<p>GDI is about to process a call to its <b>ResetDC</b> function.</p>
</td>
</tr>
<tr>
<td>
<p>DOCUMENTEVENT_STARTDOCPOST</p>
</td>
<td>
<p>GDI has just processed a call to its <b>StartDoc</b> function.</p>
</td>
</tr>
<tr>
<td>
<p>DOCUMENTEVENT_STARTDOCPRE </p>
<p>or</p>
<p>DOCUMENTEVENT_STARTDOC</p>
</td>
<td>
<p>GDI is about to process a call to its <b>StartDoc</b> function.</p>
</td>
</tr>
<tr>
<td>
<p>DOCUMENTEVENT_STARTPAGE</p>
</td>
<td>
<p>GDI is about to process a call to its <b>StartPage</b> function.</p>
</td>
</tr>
</table>
<p> </p>
</dd>

### -param cbIn 

<dd>
<p>Caller-supplied size, in bytes, of the buffer pointed to by <i>pvIn</i>.</p>
</dd>

### -param pvIn 

<dd>
<p>Caller-supplied pointer, the use of which is dependent on the value supplied for <i>iEsc</i>, as follows:</p>
<table>
<tr>
<th><i>iEsc</i> Constant</th>
<th><i>pvIn</i> Contents</th>
</tr>
<tr>
<td>
<p>DOCUMENTEVENT_ABORTDOC</p>
</td>
<td>
<p>Not used.</p>
</td>
</tr>
<tr>
<td>
<p>DOCUMENTEVENT_CREATEDCPOST</p>
</td>
<td>
<p><i>pvIn</i> contains the address of a pointer to the <a href="display.devmodew">DEVMODEW</a> structure specified in the <i>pvOut</i> parameter in a previous call to this function, for which the <i>iEsc</i> parameter was set to DOCUMENTEVENT_CREATEDCPRE.</p>
</td>
</tr>
<tr>
<td>
<p>DOCUMENTEVENT_CREATEDCPRE</p>
</td>
<td>
<p><i>pvIn</i> points to a <a href="..\winddiui\ns-winddiui--docevent-createdcpre.md">DOCEVENT_CREATEDCPRE</a> structure.</p>
</td>
</tr>
<tr>
<td>
<p>DOCUMENTEVENT_DELETEDC</p>
</td>
<td>
<p>Not used.</p>
</td>
</tr>
<tr>
<td>
<p>DOCUMENTEVENT_ENDDOCPOST</p>
</td>
<td>
<p>Not used.</p>
</td>
</tr>
<tr>
<td>
<p>DOCUMENTEVENT_ENDDOCPRE </p>
<p>or</p>
<p>DOCUMENTEVENT_ENDDOC</p>
</td>
<td>
<p>Not used.</p>
</td>
</tr>
<tr>
<td>
<p>DOCUMENTEVENT_ENDPAGE</p>
</td>
<td>
<p>Not used.</p>
</td>
</tr>
<tr>
<td>
<p>DOCUMENTEVENT_ESCAPE</p>
</td>
<td>
<p><i>pvIn</i> points to a <a href="..\winddiui\ns-winddiui--docevent-escape.md">DOCEVENT_ESCAPE</a> structure.</p>
</td>
</tr>
<tr>
<td>
<p>DOCUMENTEVENT_QUERYFILTER</p>
</td>
<td>
<p>Same as for DOCUMENTEVENT_CREATEDCPRE.</p>
</td>
</tr>
<tr>
<td>
<p>DOCUMENTEVENT_RESETDCPOST</p>
</td>
<td>
<p><i>pvIn</i> contains the address of a pointer to the <a href="display.devmodew">DEVMODEW</a> structure specified in the <i>pvOut</i> parameter in a previous call to this function, for which the <i>iEsc</i> parameter was set to DOCUMENTEVENT_RESETDCPRE.</p>
</td>
</tr>
<tr>
<td>
<p>DOCUMENTEVENT_RESETDCPRE</p>
</td>
<td>
<p><i>pvIn</i> contains the address of a pointer to a <a href="display.devmodew">DEVMODEW</a> structure supplied by the caller of <b>ResetDC</b> (described in the Microsoft Windows SDK documentation).</p>
</td>
</tr>
<tr>
<td>
<p>DOCUMENTEVENT_STARTDOCPOST</p>
</td>
<td>
<p><i>pvIn</i> points to a LONG that specifies the print job identifier returned by <b>StartDoc</b> (described in the Windows SDK documentation).</p>
</td>
</tr>
<tr>
<td>
<p>DOCUMENTEVENT_STARTDOCPRE</p>
<p>or</p>
<p>DOCUMENTEVENT_STARTDOC</p>
</td>
<td>
<p><i>pvIn</i> contains the address of a pointer to a DOCINFO structure supplied by the caller of <b>StartDoc</b> (both described in the Windows SDK documentation). </p>
</td>
</tr>
<tr>
<td>
<p>DOCUMENTEVENT_STARTPAGE</p>
</td>
<td>
<p>Not used.</p>
</td>
</tr>
</table>
<p> </p>
</dd>

### -param cbOut 

<dd>
<p></p>
<dl>

### -param If iEsc is DOCUMENTEVENT_ESCAPE:

<dd>
<p>Function-supplied value that is used as the <i>cbOutput</i> parameter for <b>ExtEscape</b>.</p>
</dd>

### -param If iEsc is DOCUMENTEVENT_QUERYFILTER:

<dd>
<p>Caller-supplied size, in bytes, of the buffer pointer to by <i>pvOut</i>.</p>
</dd>

### -param For all other iEsc values:

<dd>
<p>Not used.</p>
</dd>
</dl>
</dd>

### -param pvOut 

<dd>
<p>Function-supplied pointer to an output buffer, the use of which is dependent on the value supplied for <i>iEsc</i>, as follows. <b>CreateDC</b>, <b>ExtEscape</b>, and <b>ResetDC</b> are described in the Windows SDK documentation.</p>
<table>
<tr>
<th><i>iEsc</i> Constant</th>
<th><i>pvOut</i> Contents</th>
</tr>
<tr>
<td>
<p>DOCUMENTEVENT_CREATEDCPRE</p>
</td>
<td>
<p>Pointer to a driver-supplied DEVMODEW structure, which GDI uses instead of the one supplied by the <b>CreateDC</b> caller. (If <b>NULL</b>, GDI uses the caller-supplied structure.)</p>
</td>
</tr>
<tr>
<td>
<p>DOCUMENTEVENT_ESCAPE</p>
</td>
<td>
<p>Buffer pointer that is used as the <i>lpszOutData</i> parameter for <b>ExtEscape</b>.</p>
</td>
</tr>
<tr>
<td>
<p>DOCUMENTEVENT_QUERYFILTER</p>
</td>
<td>
<p>Caller-supplied pointer to buffer containing a <a href="..\winddiui\ns-winddiui--docevent-filter.md">DOCEVENT_FILTER</a> structure.</p>
</td>
</tr>
<tr>
<td>
<p>DOCUMENTEVENT_RESETDCPRE</p>
</td>
<td>
<p>Pointer to a driver-supplied DEVMODEW structure, which GDI uses instead of the one supplied by the <b>ResetDC</b> caller. (If <b>NULL</b>, GDI uses the caller-supplied structure.)</p>
</td>
</tr>
<tr>
<td>
<p>All other <i>iEsc</i> values</p>
</td>
<td>
<p>Not used.</p>
</td>
</tr>
</table>
<p> </p>
</dd>

### -param piResult 

<dd>
<p>Pointer to a memory location that receives one of the following values:</p>
<table>
<tr>
<th>Return Value</th>
<th>Definition</th>
</tr>
<tr>
<td>
<p>DOCUMENTEVENT_FAILURE</p>
</td>
<td>
<p>The driver supports the escape code identified by <i>iEsc</i>, but a failure occurred.</p>
</td>
</tr>
<tr>
<td>
<p>DOCUMENTEVENT_SUCCESS</p>
</td>
<td>
<p>The driver successfully handled the escape code identified by <i>iEsc</i>. Also see the Remarks section for more information.</p>
</td>
</tr>
<tr>
<td>
<p>DOCUMENTEVENT_UNSUPPORTED</p>
</td>
<td>
<p>The driver does not support the escape code identified by <i>iEsc</i>.</p>
</td>
</tr>
</table>
<p> </p>
</dd>
</dl>

## -returns
<p>This method should return one of the following values. See the Remarks section for more information.</p><dl>
<dt><b>S_OK</b></dt>
</dl><p>The UI plug-in implements this method.</p><dl>
<dt><b>E_NOTIMPL</b></dt>
</dl><p>The UI plug-in does not implement this method.</p>

<p> </p>

## -remarks
<p>A user interface plug-in's <code>IPrintOemUI2::DocumentEvent</code> method performs the same types of operations as the DrvDocumentEvent DDI that is exported by user-mode printer interface DLLs. For information about document events and how they should be processed, see the description of the <a href="..\winddiui\nf-winddiui-drvdocumentevent.md">DrvDocumentEvent</a> DDI.</p>

<p>If you provide a user interface plug-in, the printer driver's DrvDocumentEvent DDI calls the <code>IPrintOemUI2::DocumentEvent</code> method. The DrvDocumentEvent DDI performs its own processing for the specified event, and then calls the <code>IPrintOemUI2::DocumentEvent</code> method to handle additional processing of the event.</p>

<p>When this method is called with a value of the <i>iEsc</i> parameter of DOCUMENTEVENT_QUERYFILTER, and returns with *<i>piResult</i> == DOCUMENTEVENT_SUCCESS, the spooler can interpret this value in either of two ways, depending on whether certain members of the <a href="..\winddiui\ns-winddiui--docevent-filter.md">DOCEVENT_FILTER</a> structure changed values. For more information, see the Remarks section for <a href="..\winddiui\nf-winddiui-drvdocumentevent.md">DrvDocumentEvent</a>.</p>

<p>When the DOCUMENTEVENT_QUERYFILTER event is fired, the core driver calls plug-ins in the order they were installed, until one of them returns S_OK, or until all of the plug-ins have been called and none of them returned S_OK. In this way, at most one plug-in is allowed to handle the DOCUMENTEVENT_QUERYFILTER event, and the filter it specifies is applied to all plug-ins in the plug-in chain.</p>

<p>For a plug-in writer who is implementing the <b>IPrintOemUI2</b> interface, but does not need to support the <code>IPrintOemUI2::DocumentEvent</code> method, this method should return E_NOTIMPL for all values of <i>iEsc</i>. If you do need to implement this method, it should return S_OK for all values of <i>iEsc</i>. This signals the core driver that this method has handled the relevant event. The core driver uses the value that this method places in <i>piResult</i> as the return value for the <a href="..\winddiui\nf-winddiui-drvdocumentevent.md">DrvDocumentEvent</a> DDI.</p>

## -requirements
<table>
<tr>
<th width="30%">
<p>Target platform</p>
</th>
<td width="70%">
<dl>
<dt>Desktop</dt>
</dl>
</td>
</tr>
<tr>
<th width="30%">
<p>Header</p>
</th>
<td width="70%">
<dl>
<dt>Prcomoem.h (include Prcomoem.h)</dt>
</dl>
</td>
</tr>
</table>

## -see-also
<dl>
<dt>
<a href="..\winddiui\nf-winddiui-drvdocumentevent.md">DrvDocumentEvent</a>
</dt>
<dt>
<a href="..\winddiui\ns-winddiui--docevent-filter.md">DOCEVENT_FILTER</a>
</dt>
<dt>
<a href="..\winddiui\ns-winddiui--docevent-createdcpre.md">DOCEVENT_CREATEDCPRE</a>
</dt>
<dt>
<a href="..\winddiui\ns-winddiui--docevent-escape.md">DOCEVENT_ESCAPE</a>
</dt>
</dl>
<p> </p>
<p> </p>
<p><a href="mailto:wsddocfb@microsoft.com?subject=Documentation%20feedback [print\print]:%20IPrintOemUI2::DocumentEvent method%20 RELEASE:%20(11/24/2017)&amp;body=%0A%0APRIVACY STATEMENT%0A%0AWe use your feedback to improve the documentation. We don't use your email address for any other purpose, and we'll remove your email address from our system after the issue that you're reporting is fixed. While we're working to fix this issue, we might send you an email message to ask for more info. Later, we might also send you an email message to let you know that we've addressed your feedback.%0A%0AFor more info about Microsoft's privacy policy, see http://privacy.microsoft.com/en-us/default.aspx." title="Send comments about this topic to Microsoft">Send comments about this topic to Microsoft</a></p>
