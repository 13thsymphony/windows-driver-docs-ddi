---
UID: NS.bthddi._BRB_PSM
title: BRB_PSM
author: windows-driver-content
description: The _BRB_PSM structure describes a Protocol/Service Multiplexer (PSM) to register or unregister.
old-location: bltooth\_brb_psm.htm
old-project: bltooth
ms.assetid: 893edad2-8419-4c93-bf0b-2cca8ca5a2f6
ms.author: windowsdriverdev
ms.date: 11/27/2017
ms.keywords: BRB_PSM,
ms.prod: windows-hardware
ms.technology: windows-devices
ms.topic: struct
req.header: bthddi.h
req.include-header: Bthddi.h
req.target-type: Windows
req.target-min-winverclnt: Versions: Supported in Windows Vista, and later.
req.target-min-winversvr: 
req.kmdf-ver: 
req.umdf-ver: 
req.alt-api: _BRB_PSM
req.alt-loc: bthddi.h
req.ddi-compliance: 
req.unicode-ansi: 
req.idl: 
req.max-support: 
req.namespace: 
req.assembly: 
req.type-library: 
req.lib: 
req.dll: 
req.irql: Developers should code this function to operate at either IRQL = DISPATCH_LEVEL (if the callback   function does not access paged memory), or IRQL = PASSIVE_LEVEL (if the callback function must access   paged memory)
req.iface: IBidiSpl2
---

# BRB_PSM structure



## -description
<p>The _BRB_PSM structure describes a Protocol/Service Multiplexer (PSM) to register or
  unregister.</p>


## -syntax

````
struct _BRB_PSM {
  BRB_HEADER Hdr;
  USHORT     Psm;
};
````


## -struct-fields
<dl>

### -field Hdr

<dd>
<p>A 
     <a href="..\bthddi\ns-bthddi--brb-header.md">BRB_HEADER</a> structure that contains information
     about the current BRB.</p>
</dd>

### -field Psm

<dd>
<p>When the _BRB_PSM structure is passed as input for a 
     <a href="https://msdn.microsoft.com/library/windows/hardware/ff536621">BRB_REGISTER_PSM</a> BRB call, this is the PSM
     that the profile driver attempts to register. If the profile driver sets this value to zero, the PSM is
     dynamically generated. If the profile driver specified zero on <b>BRB_REGISTER_PSM</b> input, on output this
     member contains the PSM that was registered.
     </p>
<p>When the _BRB_PSM structure is passed as input for a 
     <a href="https://msdn.microsoft.com/library/windows/hardware/ff536632">BRB_UNREGISTER_PSM</a> BRB call, this is the
     PSM that the profile driver attempts to unregister. This value must be a PSM that is currently
     registered. For more information about valid PSM values, see the Remarks section.</p>
<p>Some PSMs are reserved for use by Windows:</p>
<dl>
<dd>
<p>SDP: 0x01</p>
</dd>
<dd>
<p>RFCOMM: 0x03</p>
</dd>
<dd>
<p>HID Control: 0x11</p>
</dd>
<dd>
<p>HID Data: 0x13</p>
</dd>
<dd>
<p>BNEP: 0x0F</p>
</dd>
</dl>
</dd>
</dl>

## -remarks
<p>To register a PSM, profile drivers should 
    <a href="https://msdn.microsoft.com/53a692e7-9c71-4dca-9331-32ac97b94179">build and send</a> a 
    <a href="https://msdn.microsoft.com/library/windows/hardware/ff536621">BRB_REGISTER_PSM</a> request.</p>

<p>After a PSM has been registered, the profile driver can receive connection notifications from remote
    devices and can build and send 
    <a href="bltooth.brb_l2ca_open_channel_response">
    BRB_L2CA_OPEN_CHANNEL_RESPONSE</a> requests to accept incoming connections.</p>

<p>The profile driver can specify a particular PSM or can request that a PSM be dynamically generated by
    specifying PSM_INVALID in the 
    <b>Psm</b> member. If the profile driver specifies PSM_INVALID, on output the PSM assigned will be
    returned in the 
    <b>Psm</b> member of the structure.</p>

<p>The Bluetooth driver stack registers PSMs for the following profiles: HCRP, HID, PAN, SDP, and
    RFCOMM.</p>

<p>For more information about L2CAP servers and PSMs, see 
    <a href="https://msdn.microsoft.com/26a8238d-717a-438f-84d0-047ce9618928">Accepting
    L2CAP Connections in a Bluetooth Profile Driver</a>.</p>

<p>Profile drivers cannot register a PSM that has already been registered by another driver. If one
    attempts to do so, a STATUS_ALREADY_COMMITTED error will be returned. The <b>BRB_REGISTER_PSM</b> request has no
    effect on SDP records. After registering a PSM, drivers can advertise the PSM over SDP by sending the 
    <a href="..\bthioctl\ni-bthioctl-ioctl-bth-sdp-submit-record.md">
    IOCTL_BTH_SDP_SUBMIT_RECORD</a> IOCTL.</p>

<p>To unregister a previously registered PSM, profile drivers should 
    <a href="https://msdn.microsoft.com/53a692e7-9c71-4dca-9331-32ac97b94179">build and send</a> a 
    <a href="https://msdn.microsoft.com/library/windows/hardware/ff536632">BRB_UNREGISTER_PSM</a> request. Profile
    drivers must specify a PSM that is currently registered. If a profile driver sends a BRB_REGISTER_PSM
    request with a value of zero in the 
    <b>Psm</b> member, the dynamically assigned PSM value should be passed in the BRB_UNREGISTER_PSM
    request.</p>

<p>A <b>BRB_UNREGISTER_PSM</b> request has no effect on SDP records that attempt to connect to the PSM. Profile
    drivers can remove relevant SDP records by sending the 
    <a href="..\bthioctl\ni-bthioctl-ioctl-bth-sdp-remove-record.md">
    IOCTL_BTH_SDP_REMOVE_RECORD</a> IOCTL.</p>

## -requirements
<table>
<tr>
<th width="30%">
<p>Version</p>
</th>
<td width="70%">
<p>Versions: Supported in Windows Vista, and later.</p>
</td>
</tr>
<tr>
<th width="30%">
<p>Header</p>
</th>
<td width="70%">
<dl>
<dt>Bthddi.h (include Bthddi.h)</dt>
</dl>
</td>
</tr>
</table>

## -see-also
<dl>
<dt>
<a href="..\bthddi\ns-bthddi--brb-header.md">BRB_HEADER</a>
</dt>
<dt>
<a href="https://msdn.microsoft.com/library/windows/hardware/ff536621">BRB_REGISTER_PSM</a>
</dt>
<dt>
<a href="https://msdn.microsoft.com/library/windows/hardware/ff536632">BRB_UNREGISTER_PSM</a>
</dt>
<dt>
<a href="bltooth.brb_l2ca_open_channel_response">
   BRB_L2CA_OPEN_CHANNEL_RESPONSE</a>
</dt>
<dt>
<a href="..\bthioctl\ni-bthioctl-ioctl-bth-sdp-submit-record.md">IOCTL_BTH_SDP_SUBMIT_RECORD</a>
</dt>
<dt>
<a href="..\bthioctl\ni-bthioctl-ioctl-bth-sdp-remove-record.md">IOCTL_BTH_SDP_REMOVE_RECORD</a>
</dt>
</dl>
<p> </p>
<p> </p>
<p><a href="mailto:wsddocfb@microsoft.com?subject=Documentation%20feedback [bltooth\bltooth]:%20_BRB_PSM structure%20 RELEASE:%20(11/27/2017)&amp;body=%0A%0APRIVACY STATEMENT%0A%0AWe use your feedback to improve the documentation. We don't use your email address for any other purpose, and we'll remove your email address from our system after the issue that you're reporting is fixed. While we're working to fix this issue, we might send you an email message to ask for more info. Later, we might also send you an email message to let you know that we've addressed your feedback.%0A%0AFor more info about Microsoft's privacy policy, see http://privacy.microsoft.com/en-us/default.aspx." title="Send comments about this topic to Microsoft">Send comments about this topic to Microsoft</a></p>
